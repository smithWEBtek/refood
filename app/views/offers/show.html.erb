<%= render 'layouts/flash_error' %>
<%= render 'layouts/flash_message' %>

<h1 class="slab-font sm-margin-bottom"><%= @offer.closed ? "Closed" : "Open" %> Offer</h1>
<h2 class="sm-margin-bottom"><%= @offer.headline %></h2>
<h5><%= @offer.description %></h5>
<h5 class="sm-margin-bottom"><%= @offer.user.city %>, <%= @offer.user.state %></h5>
<h6>
  <% if @offer.availability.present? %>
    <h6>Availability: <%= @offer.availability %></h6>
  <% end %>
  <h6 class="small grey-text">Posted on <%= format_date(@offer.created_at.localtime) %></h6>
</iv>


 <% if @offer.user != current_user %>
  <% if has_request(current_user, @offer) %>
    <br>
    <div class="lt-grey-box">
      <% @user = @offer.user %>
      <%= render "users/contact_info" %>
    </div>
    <br>
    <%= link_to "View your request for this item", offer_request_path(@offer, @request) %>
  <% else %>
    <br>
    <div class="lt-grey-box">
      <% @user = @offer.user %>
      <%= render "users/contact_info_limited" %>
    </div>
      <br>
    <%= link_to "Make request", new_offer_request_path(@offer), class: "btn btn-success" %>
    <%= link_to "Cancel", '/index', class: "btn btn-secondary" %>
  <% end %>
<% else %>
  <br>
  <% if @requests.count == 0 %>
    <h3><%= link_to "No open requests", offer_requests_path(@offer) %></h3>
  <% elsif @requests.count == 1 %>
    <h3><%= link_to "1 open request", offer_requests_path(@offer) %></h3>
  <% else %>
    <h3><%= link_to "#{@requests.count} open requests", offer_requests_path(@offer) %></h3>
  <% end %>

  <%= link_to "Completed requests", offer_completed_path(@offer) %>
  <br></br>
  <div class="btn-group">
    <%= link_to "Edit offer", edit_offer_path(@offer), class: "btn btn-primary" %>
    <%= button_to "Delete offer", offer_path(@offer), method: "delete", class: "btn btn-outline-danger btn-left-margin", data: { confirm: "Are you sure you want to delete this offer?"} %>
  </div>
<% end %>
